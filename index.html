<!DOCTYPE html>
    <head>
        <!-- Spotify CSS files -->
        <link rel="stylesheet" type="text/css" href="sp://resources/css/eve.css">
        <link rel="stylesheet" type="text/css" href="sp://resources/css/api.css">
        <link rel="stylesheet" type="text/css" href="sp://resources/css/player.css">
        <link rel="stylesheet" type="text/css" href="sp://resources/css/list.css">

        <!-- Project CSS files -->
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link rel="stylesheet" type="text/css" href="css/github.css">
    </head>
    <body>
        <div id="wrapper">
            <div id="index" class="section">
                <h1>Showlist</h1>
				<p class="description">Drag playlists to the box, select sources of shows, then press Go.</p>

                <h4>Playlists</h4>
--
				    <div>
				        <div id="drop_box"></div>
				        <ul id="playlist"></ul>
				    </div>
				<script type="text/javascript">
				    var sp = getSpotifyApi();
				    var models = sp.require('$api/models');

				    // Handle drops
				    var drop_box = document.querySelector('#drop_box');

				    drop_box.addEventListener('dragstart', function(e){
				        e.dataTransfer.setData('text/html', this.innerHTML);
				        e.dataTransfer.effectAllowed = 'copy';
				    }, false);

				    drop_box.addEventListener('dragenter', function(e){
				        e.preventDefault();
				        e.dataTransfer.dropEffect = 'copy';
				        this.classList.add('over');
				    }, false);

				    drop_box.addEventListener('dragover', function(e){
				        e.preventDefault();
				        e.dataTransfer.dropEffect = 'copy';
				        return false;
				    }, false);

				    drop_box.addEventListener('dragleave', function(e){
				        e.preventDefault();
				        this.classList.remove('over');
				    }, false);

				    drop_box.addEventListener('drop', function(e){
				        e.preventDefault();
				        var drop = models.Playlist.fromURI(e.dataTransfer.getData('text'));
				        this.classList.remove('over');
				        var success_message = document.createElement('p');
				        success_message.innerHTML = 'Playlist successfully dropped: ' + drop.uri;
				        this.appendChild(success_message);
						drawPlaylist(drop.uri);
				    }, false);

				    function pullShows(pull_url) {
				        $.ajax({
				        	url: pull_url
				        }).done(function(html) {
				        	var shows = $(html).text();
				        	console.log(shows);
				        });
					}

					function drawPlaylist(playlist_url) {
					    var playlistHTML = document.getElementById('playlist');

					    var pl = models.Playlist.fromURI(playlist_url, function(playlist) {
					        var fragment = document.createDocumentFragment();
					        for (var i = 0, l = playlist.tracks.length; i < l; i++){
					            var link = document.createElement('li');
					            var a = document.createElement('a');
					            a.href = playlist.tracks[i].uri;
					            a.innerHTML = playlist.tracks[i].name;
					            link.appendChild(a);
					            fragment.appendChild(link);
					        }
					        playlistHTML.appendChild(fragment);
						});
					}

				</script>


--
            </div>
        </div>
        <script src="/js/rainbow-custom.min.js"></script>
        <script src="/js/tutorial.js"></script>
        <script src="/js/jquery.min.js"></script>
    </body>
</html>
